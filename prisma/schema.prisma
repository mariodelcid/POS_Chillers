generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Item {
  id         Int      @id @default(autoincrement())
  name       String   @unique
  category   String
  priceCents Int
  stock      Int      @default(0)
  imageUrl   String?
  packaging  String?  // packaging material used for this item
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  saleItems  SaleItem[]
}

model PackagingMaterial {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  stock     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Sale {
  id                   Int        @id @default(autoincrement())
  createdAt            DateTime   @default(now())
  paymentMethod        String
  subtotalCents        Int
  taxCents             Int
  totalCents           Int
  amountTenderedCents  Int?
  changeDueCents       Int?

  items SaleItem[]
}

model SaleItem {
  id             Int   @id @default(autoincrement())
  saleId         Int
  itemId         Int
  quantity       Int
  unitPriceCents Int
  lineTotalCents Int

  sale Sale @relation(fields: [saleId], references: [id])
  item Item @relation(fields: [itemId], references: [id])
}

model Purchase {
  id              Int      @id @default(autoincrement())
  amountCents     Int
  description     String
  paymentMethod   String   @default("cash") // "cash" or "card"
  receiptUrl      String?  // URL to uploaded receipt file
  createdAt       DateTime @default(now())
}

model TimeEntry {
  id           Int      @id @default(autoincrement())
  employeeName String
  type         String   // 'clock_in' or 'clock_out'
  timestamp    DateTime @default(now())
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model AccountingEntry {
  id              Int      @id @default(autoincrement())
  date            DateTime @unique // Date for this accounting entry (start of day in local timezone)
  cashSales       Int      @default(0) // Total cash sales for the day
  creditSales     Int      @default(0) // Total credit sales for the day
  squareFees      Int      @default(0) // Square processing fees
  salesTax        Int      @default(0) // Sales tax collected
  deposits        Int      @default(0) // Cash deposits made
  taxPayments     Int      @default(0) // Tax payments made
  netCash         Int      @default(0) // Calculated: cashSales - deposits - taxPayments
  netCredit       Int      @default(0) // Calculated: creditSales - squareFees
  balance         Int      @default(0) // Running balance
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}


